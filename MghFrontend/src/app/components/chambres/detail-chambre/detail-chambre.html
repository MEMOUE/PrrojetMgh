<div class="min-h-screen bg-gray-50 py-8 px-4">
  <div class="max-w-6xl mx-auto">

    <!-- Header -->
    <div class="mb-8 flex items-center justify-between">
      <div>
        <button pButton label="Retour" icon="pi pi-arrow-left" 
                class="!bg-gray-100 !text-gray-700 mb-4" (click)="goBack()">
        </button>
        <h1 class="text-3xl font-bold">Chambre #{{ chambre?.numero }}</h1>
      </div>

      <div class="flex gap-2" *ngIf="chambre">
        <button pButton label="Modifier" icon="pi pi-pencil" 
                class="!bg-indigo-600" (click)="editChambre()">
        </button>
        <button pButton icon="pi pi-trash" 
                class="!bg-red-600" (click)="confirmDelete()">
        </button>
      </div>
    </div>

    <!-- Chargement -->
    <div *ngIf="loading" class="bg-white rounded-lg shadow-sm p-12 text-center">
      <i class="pi pi-spinner pi-spin text-5xl text-indigo-600 mb-4"></i>
      <p class="text-gray-600 text-lg">Chargement...</p>
    </div>

    <!-- Erreur -->
    <div *ngIf="errorMessage && !loading" class="bg-red-50 border-l-4 border-red-500 p-4 rounded mb-6">
      <p class="text-red-700">{{ errorMessage }}</p>
    </div>

    <!-- Contenu -->
    <div *ngIf="chambre && !loading" class="space-y-6">

      <!-- Image -->
      <div class="bg-white rounded-lg shadow-sm overflow-hidden">
        <div class="relative h-96 bg-gradient-to-br from-indigo-400 to-purple-500">
          <div class="w-full h-full flex items-center justify-center">
            <i class="pi pi-image text-white text-8xl opacity-50"></i>
          </div>

          <div class="absolute top-6 right-6">
            <span class="px-4 py-2 rounded-lg text-sm font-bold shadow-lg"
              [ngClass]="{
                'bg-green-500 text-white': chambre.statut === 'DISPONIBLE',
                'bg-red-500 text-white': chambre.statut === 'OCCUPEE',
                'bg-yellow-500 text-white': chambre.statut === 'EN_NETTOYAGE',
                'bg-blue-500 text-white': chambre.statut === 'EN_MAINTENANCE' || chambre.statut === 'RESERVEE',
                'bg-gray-500 text-white': chambre.statut === 'HORS_SERVICE'
              }">
              {{ getStatutLabel(chambre.statut || 'DISPONIBLE') }}
            </span>
          </div>

          <div class="absolute bottom-6 left-6">
            <span class="text-white text-5xl font-black">#{{ chambre.numero }}</span>
          </div>

          <div class="absolute bottom-6 right-6 bg-white/90 rounded-lg px-4 py-2">
            <div class="text-3xl font-bold text-indigo-600">
              {{ chambre.prixParNuit | number:'1.0-0' }}
            </div>
            <div class="text-sm text-gray-600">FCFA / nuit</div>
          </div>
        </div>
      </div>

      <!-- Infos -->
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <div class="lg:col-span-2 space-y-6">

          <div class="bg-white rounded-lg shadow-sm p-6">
            <h2 class="text-xl font-semibold mb-4">Informations</h2>

            <div class="grid grid-cols-2 gap-6">
              <div>
                <div class="text-sm text-gray-500 mb-1">Type</div>
                <div class="text-lg font-semibold">{{ getTypeLabel(chambre.type) }}</div>
              </div>

              <div>
                <div class="text-sm text-gray-500 mb-1">Étage</div>
                <div class="text-lg font-semibold">
                  {{ chambre.etage === 0 ? 'Rez-de-chaussée' : 'Étage ' + chambre.etage }}
                </div>
              </div>

              <div>
                <div class="text-sm text-gray-500 mb-1">Capacité</div>
                <div class="text-lg font-semibold">{{ chambre.capacite }} personne(s)</div>
              </div>

              <div *ngIf="chambre.superficie">
                <div class="text-sm text-gray-500 mb-1">Superficie</div>
                <div class="text-lg font-semibold">{{ chambre.superficie }} m²</div>
              </div>
            </div>
          </div>

          <div *ngIf="chambre.description" class="bg-white rounded-lg shadow-sm p-6">
            <h2 class="text-xl font-semibold mb-4">Description</h2>
            <p class="text-gray-700">{{ chambre.description }}</p>
          </div>

        </div>

        <!-- Sidebar -->
        <div class="space-y-6">

          <div class="bg-white rounded-lg shadow-sm p-6">
            <h2 class="text-xl font-semibold mb-4">Résumé</h2>

            <div class="space-y-4">
              <div class="flex justify-between pb-3 border-b">
                <span class="text-gray-600">Prix</span>
                <span class="text-xl font-bold text-indigo-600">
                  {{ chambre.prixParNuit | number:'1.0-0' }} FCFA
                </span>
              </div>

              <div class="flex justify-between pb-3 border-b">
                <span class="text-gray-600">Statut</span>
                <span class="px-3 py-1 rounded-full text-sm font-semibold"
                  [ngClass]="{
                    'bg-green-100 text-green-800': chambre.statut === 'DISPONIBLE',
                    'bg-red-100 text-red-800': chambre.statut === 'OCCUPEE',
                    'bg-yellow-100 text-yellow-800': chambre.statut === 'EN_NETTOYAGE',
                    'bg-blue-100 text-blue-800': chambre.statut === 'EN_MAINTENANCE' || chambre.statut === 'RESERVEE',
                    'bg-gray-100 text-gray-800': chambre.statut === 'HORS_SERVICE'
                  }">
                  {{ getStatutLabel(chambre.statut || 'DISPONIBLE') }}
                </span>
              </div>

              <div class="flex justify-between">
                <span class="text-gray-600">Type</span>
                <span class="font-semibold">{{ getTypeLabel(chambre.type) }}</span>
              </div>
            </div>
          </div>

          <div class="bg-white rounded-lg shadow-sm p-6">
            <h2 class="text-xl font-semibold mb-4">Actions</h2>

            <div class="space-y-3">
              <button pButton label="Changer statut" icon="pi pi-sync" 
                      class="w-full !bg-blue-600" (click)="showChangeStatutDialog()">
              </button>
            </div>
          </div>

        </div>

      </div>

    </div>

  </div>
</div>

<!-- Dialog statut -->
<p-dialog [(visible)]="showStatutDialog" [modal]="true" [style]="{width: '450px'}" header="Changer statut">
  <div class="mb-4">
    <label class="block text-sm font-medium mb-2">Nouveau statut</label>
    <p-select [options]="statuts" [(ngModel)]="nouveauStatut" 
              placeholder="Sélectionner" optionLabel="label" optionValue="value" styleClass="w-full">
    </p-select>
  </div>

  <ng-template pTemplate="footer">
    <button pButton label="Annuler" (click)="showStatutDialog = false"></button>
    <button pButton label="Confirmer" class="!bg-indigo-600" 
            (click)="changeStatut()" [disabled]="!nouveauStatut">
    </button>
  </ng-template>
</p-dialog>

<!-- Dialog suppression -->
<p-dialog [(visible)]="showDeleteDialog" [modal]="true" [style]="{width: '450px'}" header="Confirmer">
  <div class="flex items-start gap-4">
    <i class="pi pi-exclamation-triangle text-red-500 text-3xl"></i>
    <div>
      <p>Supprimer la chambre <strong>#{{ chambre?.numero }}</strong> ?</p>
      <p class="text-sm text-gray-500">Irréversible.</p>
    </div>
  </div>

  <ng-template pTemplate="footer">
    <button pButton label="Annuler" (click)="showDeleteDialog = false"></button>
    <button pButton label="Supprimer" class="!bg-red-600" 
            (click)="deleteChambre()" [loading]="deleting">
    </button>
  </ng-template>
</p-dialog>

<p-toast position="top-right"></p-toast>